{% extends "admin/change_list.html" %}
{% load static %}

{% block sidebar %}
    <!-- Удаляем весь блок sidebar -->
{% endblock %}

{% block object-tools %}
    <!-- Удаляем все содержимое блока object-tools -->
{% endblock %}

{% block content_title %}
    <!-- Удаляем заголовок страницы -->
{% endblock %}

{% block search %}
<div id="toolbar" style="display: flex; align-items: center;">
    <!-- Форма поиска -->
    <form id="changelist-search" method="get" style="margin-right: 8px;">
        <div style="display: flex; align-items: center;">
            <label for="searchbar" style="margin-right: 8px;">
                <img src="{% static 'admin/img/search.svg' %}" alt="Search">
            </label>
            <input type="text" size="40" name="q" value="{{ cl.query }}" id="searchbar">
            <input type="submit" value="Найти" class="default">
        </div>
    </form>

    <!-- Форма для обновления прайс-листов -->
    <form method="post" action="{% url 'renew_prices' %}">
        {% csrf_token %}
        <input type="submit" value="Обновить прайс-листы" name="renew_prices" class="default">
    </form>
    <!-- Форма для скачивания объединенного прайса только смещаем кнопку к правому краю-->
    <form method="post" action="{% url 'download_prices' %}" style="margin-left: auto;">
    {% csrf_token %}
    <input type="submit" value="Выгрузить всё в Excel" name="download_prices" class="default">
    </form>
</div>
{% endblock %}


{% block pagination %}
<div class="paginator">
    {% if cl.paginator.num_pages > 1 %}
        <span class="step-links">

            {% if cl.page_num > 0 %}
                <a href="?{% if cl.params %}{{ cl.params|urlencode }}&{% endif %}p=0" class="button">1</a>
            {% endif %}

            {% if cl.page_num > 10 %}
                <a href="?{% if cl.params %}{{ cl.params|urlencode }}&{% endif %}p={{ cl.page_num|add:'-10' }}" class="button">&laquo; -10</a>
            {% endif %}

            {% if cl.page_num > 0 %}
                <a href="?{% if cl.params %}{{ cl.params|urlencode }}&{% endif %}p={{ cl.page_num|add:'-1' }}" class="button">&#8592; Предыдущая</a>
            {% endif %}

            <span class="current">
                Страница {{ cl.page_num|add:"1" }} из {{ cl.paginator.num_pages }}
            </span>

            {% if cl.page_num < cl.paginator.num_pages|add:'-1' %}
                <a href="?{% if cl.params %}{{ cl.params|urlencode }}&{% endif %}p={{ cl.page_num|add:'1' }}" class="button">Следующая &#8594;</a>
            {% endif %}

            {% if cl.page_num|add:'10' < cl.paginator.num_pages %}
                <a href="?{% if cl.params %}{{ cl.params|urlencode }}&{% endif %}p={{ cl.page_num|add:'10' }}" class="button">+10 &raquo;</a>
            {% endif %}

            {% if cl.page_num < cl.paginator.num_pages|add:'-1' %}
                <a href="?{% if cl.params %}{{ cl.params|urlencode }}&{% endif %}p={{ cl.paginator.num_pages|add:'-1' }}" class="button">{{ cl.paginator.num_pages }}</a>
            {% endif %}

            <!-- Поле ввода страницы с кнопкой -->
            <form method="get" style="display: inline-block; margin-left: 10px;">
                {% for key, value in cl.params.items %}
                    {% if key != 'p' %}
                        <input type="hidden" name="{{ key }}" value="{{ value }}">
                    {% endif %}
                {% endfor %}
                <input type="number" name="p" min="0" max="{{ cl.paginator.num_pages|add:'-1' }}" value="{{ cl.page_num }}" style="width: 50px;">
                <button type="submit" class="button">Перейти</button>
            </form>

        </span>
    {% endif %}
</div>
{% endblock %}



